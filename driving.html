<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Road map – Permis auto & moto</title>
  <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>
<header>
  <div class="wrap brand">
    <h1><img src="assets/img/logo.svg" alt="" style="vertical-align:middle;margin-right:.5rem"/>Road map – Permis auto & moto</h1>
    <nav>
      <a class="navlink" href="index.html">Accueil</a>
      <a class="navlink" href="flow.html">Flow</a>
      <a class="navlink" href="timeline.html">Timeline</a>
      <a class="navlink" href="focus.html">Focus</a>
      <a class="navlink" href="edu.html">Sciences de l’éducation</a>
      <a class="navlink" href="oulpan.html">Oulpan hébreu</a>
      <a class="navlink" href="vae.html">VAE Paris 8</a>
      <a class="navlink" href="master.html">Candidature Master (HUJI)</a>
      <a class="navlink" href="driving.html">Permis auto & moto</a>
      <a class="navlink" href="crea.html">Créa : Photo, Guitare & DJ</a>
      <a class="navlink" href="ong.html">Projet ONG</a>
    </nav>
  </div>
</header>
<main>
  <div class="subtitle">Code ETG/ETM, conduite & plateau, circulation, administratif — tout au même endroit.</div>
  

<div class="card">
  <div class="month"><h2>Objectifs hebdo</h2><span class="badge">Reset auto lundi</span></div>
  <div class="section">Suivi</div>
  <ul id="weeklyList"></ul>
  <div class="card-tools">
    <a class="btn small" id="weeklyReset">Remettre à zéro (cette semaine)</a>
  </div>
</div>


<div id="weeklyBanner" class="card" style="border:1px dashed #f59e0b; background:#0b1220; margin-bottom:1rem;">
  <div class="month"><h2>Rappel hebdo</h2><span class="badge">Dimanche</span></div>
  <div class="muted" id="weeklyBannerText">Tout est OK pour l’instant.</div>
</div>

<div class="subtitle">Road map – Permis voiture (B)</div>
<div class="toolbar">
  <input class="search" type="search" placeholder="Rechercher">
  <a class="btn expand">Tout ouvrir</a>
  <a class="btn collapse">Tout fermer</a>
  <a class="btn reset">Réinitialiser progression</a>
  <a class="btn print">Exporter en PDF</a>
</div>
<div class="toolbar">
  <div style="flex:1 1 320px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.35rem;">
      <span>Progression globale</span>
      <strong class="globalPct">0%</strong>
    </div>
    <div class="barwrap"><div class="bar globalBar" style="width:0%"></div></div>
  </div>
</div>
<div class="grid">
  
        <div class="card">
          <div class="month"><h2>Code (théorie)</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Code (théorie)::0"> <span>S’inscrire à une auto-école & créer compte ANTS</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Code (théorie)::1"> <span>Thèmes du code (priorités, panneaux, vitesse, alcool/stupéfiants)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Code (théorie)::2"> <span>Séries d’entraînement quotidiennes (40 questions)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Code (théorie)::3"> <span>Examen blanc (≥35/40) — 5 fois d’affilée</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Code (théorie)::4"> <span>Réservation de l’épreuve ETG (code)</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        
        <div class="card">
          <div class="month"><h2>Conduite (pratique)</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::0"> <span>Évaluation de départ (volume d’heures)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::1"> <span>Maîtrise du véhicule (démarrage, arrêt, rétrovision)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::2"> <span>Circulation urbaine (priorités, intersections)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::3"> <span>Route/autoroute (insertions, dépassements, distances)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::4"> <span>Manœuvres (créneau, bataille, demi-tour)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::5"> <span>2h de conduite de nuit / par temps de pluie (si possible)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Conduite (pratique)::6"> <span>Prépa examen : parcours + vérifications intérieures/extérieures</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        
        <div class="card">
          <div class="month"><h2>Administratif</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Administratif::0"> <span>Numéro NEPH (ANTS)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Administratif::1"> <span>Achat timbre fiscal (si requis)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Administratif::2"> <span>Pièces : pièce d’identité, justificatif de domicile, e-photo</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Administratif::3"> <span>Convocation ETG & pratique</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="car::Administratif::4"> <span>Demande de permis définitif après réussite</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        

<div class="card">
  <div class="month"><h2>Parcours express (4 semaines)</h2><span class="badge">S1→S4</span></div>
  <ul>
    <li><strong>S1 – Code intensif :</strong> 5× séries de 40 questions, revoir erreurs, thèmes priorités/panneaux. Objectif : ≥ 32/40.</li>
    <li><strong>S2 – Code + premières heures :</strong> 5× séries + 2–4h conduite (maîtrise véhicule). Objectif : ≥ 35/40.</li>
    <li><strong>S3 – Examens blancs & circulation :</strong> 5 examens blancs (≥ 36/40), 4–6h de conduite (urbain + manœuvres).</li>
    <li><strong>S4 – Réservation & prépa pratique :</strong> Réserver ETG, 4–6h conduite (route/autoroute), check vérifs int./ext.</li>
  </ul>
</div>
<div class="card">
  <div class="month"><h2>Ressources officielles</h2><span class="badge">Liens utiles</span></div>
  <ul>
    <li><a target="_blank" rel="noopener" href="https://permisdeconduire.ants.gouv.fr/">ANTS – Permis de conduire</a></li>
    <li><a target="_blank" rel="noopener" href="https://www.service-public.fr/particuliers/vosdroits/N530">Service-Public – Épreuve théorique (code)</a></li>
    <li><a target="_blank" rel="noopener" href="https://www.securite-routiere.gouv.fr/">Sécurité routière – Thèmes & panneaux</a></li>
  </ul>
</div>

<div class="card">
  <div class="month"><h2>Ressources d’entraînement (code ETG)</h2><span class="badge">Pratique</span></div>
  <ul>
    <li>Plateformes d’entraînement en ligne (ex. séries chronométrées, examens blancs)</li>
    <li>Applications mobiles (révisions flash, panneaux, priorités)</li>
    <li>Auto-école en ligne / présentiel : demander accès séries “thèmes difficiles”</li>
    <li>Mémo perso : noter systématiquement les erreurs récurrentes et la règle associée</li>
  </ul>
</div>

</div>
<script type="module">
  import { initChecklist } from './assets/js/app.js';
  initChecklist(document.querySelector('main'), 'car_progress');

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>

<script type="module">
  // Weekly objectives (fixed presets). Reset Monday.
  import {{ loadProgress, saveProgress }} from './assets/js/app.js';
  const KEY = 'car_weekly';
  const PRESET = [{"id": "code_series", "title": "Séries code ETG", "target": 5, "unit": "séries"}, {"id": "driving_hours", "title": "Heures de conduite", "target": 4, "unit": "h", "step2": 1}];
  const list = document.getElementById('weeklyList');
  function monday(d){{ const dt=new Date(d); const day=(dt.getDay()+6)%7; dt.setDate(dt.getDate()-day); dt.setHours(0,0,0,0); return dt; }}
  function weekKey(){{ return monday(new Date()).toISOString().slice(0,10); }}
  function load(){{ let s=loadProgress(KEY); if(!s || s.week!==weekKey()) s={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; return s; }}
  let STATE = load();
  function save(){{ saveProgress(KEY, STATE); render(); }}
  function render(){{ list.innerHTML = PRESET.map(p=>{{
      const val = STATE.items[p.id]||0;
      const pct = Math.min(100, Math.round(100*val/p.target));
      return `<li><strong>${{p.title}}</strong> — ${{val}} / ${{p.target}} ${{p.unit}}
        <div class='barwrap'><div class='bar' style='width:${{pct}}%'></div></div>
        <div class='links'><a class='btn small' data-inc='${{p.id}}'>+1</a>${{p.step2?` <a class='btn small' data-inc2='${{p.id}}'>+${{p.step2}}</a>`:''}}</div></li>`;
    }}).join('');
    list.querySelectorAll('[data-inc]').forEach(b=> b.addEventListener('click', ()=>{{ const id=b.getAttribute('data-inc'); STATE.items[id]=(STATE.items[id]||0)+1; save(); }}));
    list.querySelectorAll('[data-inc2]').forEach(b=> b.addEventListener('click', ()=>{{ const id=b.getAttribute('data-inc2'); STATE.items[id]=(STATE.items[id]||0)+1; save(); }}));
  }}
  document.getElementById('weeklyReset')?.addEventListener('click', ()=>{{ STATE={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; save(); }});
  if(STATE.week!==weekKey()){{ STATE={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; save(); }}
  render();

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>


<script type="module">
  // Weekly reminder: if Sunday and objectives < 100%, show banner
  (function(){
    const isSunday = (new Date().getDay()) === 0; // 0=Sunday
    const list = document.getElementById('weeklyList');
    const banner = document.getElementById('weeklyBanner');
    const txt = document.getElementById('weeklyBannerText');
    if(!list || !banner || !txt) return;
    if(!isSunday){ banner.classList.add('hidden'); return; }
    const bars = list.querySelectorAll('.barwrap .bar');
    let allOk = true;
    bars.forEach(b=>{
      const w = parseInt(b.style.width||'0');
      if(w < 100) allOk = false;
    });
    if(allOk){
      banner.style.borderColor = '#34d399';
      txt.textContent = '✅ Objectifs hebdo atteints. Bravo !';
    }else{
      banner.style.borderColor = '#f59e0b';
      txt.textContent = '⏰ Il reste des objectifs à compléter cette semaine.';
    }
  })();

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>



<div class="card">
  <div class="month"><h2>Objectifs hebdo</h2><span class="badge">Reset auto lundi</span></div>
  <div class="section">Suivi</div>
  <ul id="weeklyList"></ul>
  <div class="card-tools">
    <a class="btn small" id="weeklyReset">Remettre à zéro (cette semaine)</a>
  </div>
</div>


<div id="weeklyBanner" class="card" style="border:1px dashed #f59e0b; background:#0b1220; margin-bottom:1rem;">
  <div class="month"><h2>Rappel hebdo</h2><span class="badge">Dimanche</span></div>
  <div class="muted" id="weeklyBannerText">Tout est OK pour l’instant.</div>
</div>

<div class="subtitle">Road map – Permis moto (A1/A2)</div>
<div class="toolbar">
  <input class="search" type="search" placeholder="Rechercher">
  <a class="btn expand">Tout ouvrir</a>
  <a class="btn collapse">Tout fermer</a>
  <a class="btn reset">Réinitialiser progression</a>
  <a class="btn print">Exporter en PDF</a>
</div>
<div class="toolbar">
  <div style="flex:1 1 320px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.35rem;">
      <span>Progression globale</span>
      <strong class="globalPct">0%</strong>
    </div>
    <div class="barwrap"><div class="bar globalBar" style="width:0%"></div></div>
  </div>
</div>
<div class="grid">
  
        <div class="card">
          <div class="month"><h2>Code (ETM)</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Code (ETM)::0"> <span>Créer dossier ANTS & s’inscrire ETM</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Code (ETM)::1"> <span>Thèmes ETM spécifiques moto (équipements, stabilité, trajectoires)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Code (ETM)::2"> <span>Séries d’entraînement quotidiennes (40 questions)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Code (ETM)::3"> <span>Examens blancs (≥35/40) — 5 d’affilée</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        
        <div class="card">
          <div class="month"><h2>Plateau (hors circulation)</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Plateau (hors circulation)::0"> <span>Équilibre & poussette</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Plateau (hors circulation)::1"> <span>Demi-tours & slaloms (lent/rapide)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Plateau (hors circulation)::2"> <span>Freinage d’urgence & évitement</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Plateau (hors circulation)::3"> <span>Parcours examen (chronométré)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Plateau (hors circulation)::4"> <span>Vérifs sécurité moto (pneus, freins, éclairage)</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        
        <div class="card">
          <div class="month"><h2>Circulation</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Circulation::0"> <span>Conduite en ville (positionnement, angles morts)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Circulation::1"> <span>Routes/voies rapides (anticipation, distances)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Circulation::2"> <span>Situations complexes (giratoires, interfiles selon législation)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Circulation::3"> <span>Prépa examen : parcours type + consignes</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        
        <div class="card">
          <div class="month"><h2>Administratif</h2><span class="pct">0%</span></div>
          <details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Administratif::0"> <span>NEPH (ANTS) & pièce d’identité, justificatifs</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Administratif::1"> <span>Équipement homologué (casque, gants CE)</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Administratif::2"> <span>Convocations ETM / plateau / circulation</span></label></summary></details>
<details><summary><label class="progress"><input type="checkbox" class="cb" data-id="moto::Administratif::3"> <span>Demande de permis A1/A2 après réussite</span></label></summary></details>
          <div class="card-tools">
            <a class="btn small mark-card">Tout cocher</a>
            <a class="btn small unmark-card">Tout décocher</a>
            <a class="btn small toggle-card">Ouvrir/Fermer tous</a>
          </div>
        </div>
        

<div class="card">
  <div class="month"><h2>Parcours express (4 semaines)</h2><span class="badge">S1→S4</span></div>
  <ul>
    <li><strong>S1 – ETM + équilibre :</strong> 5× séries ETM (40q), poussette, équilibre, trajectoires lentes.</li>
    <li><strong>S2 – Plateau :</strong> slaloms lent/rapide, freinage d’urgence, évitement. Objectif : enchaîner sans faute.</li>
    <li><strong>S3 – ETM blanc + plateau chrono :</strong> ≥ 36/40 sur 3 blancs, parcours plateau dans le temps imparti.</li>
    <li><strong>S4 – Circulation :</strong> ville + voies rapides, positionnements & angles morts. Réservation des épreuves.</li>
  </ul>
</div>
<div class="card">
  <div class="month"><h2>Ressources officielles</h2><span class="badge">Liens utiles</span></div>
  <ul>
    <li><a target="_blank" rel="noopener" href="https://permisdeconduire.ants.gouv.fr/">ANTS – Permis moto</a></li>
    <li><a target="_blank" rel="noopener" href="https://www.service-public.fr/particuliers/vosdroits/F2827">Service-Public – Permis A1/A2</a></li>
    <li><a target="_blank" rel="noopener" href="https://www.securite-routiere.gouv.fr/">Sécurité routière – ETM & équipements</a></li>
  </ul>
</div>

<div class="card">
  <div class="month"><h2>Ressources d’entraînement (ETM)</h2><span class="badge">Pratique</span></div>
  <ul>
    <li>Plateformes ETM (thèmes spécifiques moto : équipements, trajectoires, freinages)</li>
    <li>Vidéos pédagogiques (plateau : slalom lent/rapide, évitement, freinage urgence)</li>
    <li>Fiches mémo sécurité (pneus, pression, chaîne, freins, éclairage)</li>
  </ul>
</div>

</div>
<script type="module">
  import { initChecklist } from './assets/js/app.js';
  initChecklist(document.querySelector('main'), 'moto_progress');

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>

<script type="module">
  // Weekly objectives (fixed presets). Reset Monday.
  import {{ loadProgress, saveProgress }} from './assets/js/app.js';
  const KEY = 'moto_weekly';
  const PRESET = [{"id": "etm_series", "title": "Séries ETM", "target": 5, "unit": "séries"}, {"id": "plateau_sessions", "title": "Sessions plateau", "target": 2, "unit": "sessions"}, {"id": "circulation_hours", "title": "Heures circulation", "target": 2, "unit": "h", "step2": 1}];
  const list = document.getElementById('weeklyList');
  function monday(d){{ const dt=new Date(d); const day=(dt.getDay()+6)%7; dt.setDate(dt.getDate()-day); dt.setHours(0,0,0,0); return dt; }}
  function weekKey(){{ return monday(new Date()).toISOString().slice(0,10); }}
  function load(){{ let s=loadProgress(KEY); if(!s || s.week!==weekKey()) s={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; return s; }}
  let STATE = load();
  function save(){{ saveProgress(KEY, STATE); render(); }}
  function render(){{ list.innerHTML = PRESET.map(p=>{{
      const val = STATE.items[p.id]||0;
      const pct = Math.min(100, Math.round(100*val/p.target));
      return `<li><strong>${{p.title}}</strong> — ${{val}} / ${{p.target}} ${{p.unit}}
        <div class='barwrap'><div class='bar' style='width:${{pct}}%'></div></div>
        <div class='links'><a class='btn small' data-inc='${{p.id}}'>+1</a>${{p.step2?` <a class='btn small' data-inc2='${{p.id}}'>+${{p.step2}}</a>`:''}}</div></li>`;
    }}).join('');
    list.querySelectorAll('[data-inc]').forEach(b=> b.addEventListener('click', ()=>{{ const id=b.getAttribute('data-inc'); STATE.items[id]=(STATE.items[id]||0)+1; save(); }}));
    list.querySelectorAll('[data-inc2]').forEach(b=> b.addEventListener('click', ()=>{{ const id=b.getAttribute('data-inc2'); STATE.items[id]=(STATE.items[id]||0)+1; save(); }}));
  }}
  document.getElementById('weeklyReset')?.addEventListener('click', ()=>{{ STATE={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; save(); }});
  if(STATE.week!==weekKey()){{ STATE={{week:weekKey(), items:Object.fromEntries(PRESET.map(p=>[p.id,0]))}}; save(); }}
  render();

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>


<script type="module">
  // Weekly reminder: if Sunday and objectives < 100%, show banner
  (function(){
    const isSunday = (new Date().getDay()) === 0; // 0=Sunday
    const list = document.getElementById('weeklyList');
    const banner = document.getElementById('weeklyBanner');
    const txt = document.getElementById('weeklyBannerText');
    if(!list || !banner || !txt) return;
    if(!isSunday){ banner.classList.add('hidden'); return; }
    const bars = list.querySelectorAll('.barwrap .bar');
    let allOk = true;
    bars.forEach(b=>{
      const w = parseInt(b.style.width||'0');
      if(w < 100) allOk = false;
    });
    if(allOk){
      banner.style.borderColor = '#34d399';
      txt.textContent = '✅ Objectifs hebdo atteints. Bravo !';
    }else{
      banner.style.borderColor = '#f59e0b';
      txt.textContent = '⏰ Il reste des objectifs à compléter cette semaine.';
    }
  })();

  // Theme toggle with persistence
  (function(){
    const KEY='pref_theme';
    const btn = document.getElementById('themeToggle');
    function apply(t){ document.documentElement.setAttribute('data-theme', t); if(btn) btn.textContent = 'Thème: ' + (t==='light'?'Clair':'Sombre'); }
    const saved = localStorage.getItem(KEY) || 'dark';
    apply(saved);
    btn?.addEventListener('click', ()=>{ const cur = document.documentElement.getAttribute('data-theme')||'dark'; const next = cur==='dark'?'light':'dark'; localStorage.setItem(KEY,next); apply(next); });
  })();

</script>


</main>
<footer>Conçu pour Ruben • © 2025</footer>
<script type="module">
  import { initChecklist } from './assets/js/app.js';
  // Initialize both namespaces within merged content
  initChecklist(document.querySelector('main'), 'car_progress');
  initChecklist(document.querySelector('main'), 'moto_progress');
</script>
<script type="module">
  // Theme toggle persistence
  (function(){
    const KEY='pref_theme'; const btn=document.getElementById('themeToggle');
    const saved=localStorage.getItem(KEY)||'dark'; document.documentElement.setAttribute('data-theme', saved);
  })();
</script>
</body>
</html>
